# Instructions to Create a PL Question with GPT-3.5 Feedback

## Preface
The following instructions are condensed, and are written for advanced question-writers. If you're new to PrairieLearn, or would prefer a more comprehensive breakdown, please consult our [beginner-friendly documentation](https://docs.google.com/document/d/1-3SF2KoPc5EGUDPnR4VhSJAHUxXIDkKyWjJ1_9BdnII/edit?usp=sharing) :-)

## Prerequisites

You will require access to:
- The OpenAI API with a valid API key — consult the instructions [here](#).
	- You will have to purchase API tokens — instructions [here](#).
- A text editor.

## Directory Structure

The following instructions will help you write the necessary files for your question. Here’s the overall directory structure you should follow:
```
├── info.json 
├── initial_code.py 
├── question.html 
└── tests/ 
	├── ans.py 
	├── setup_code.py 
	└── test.py	
```
## Modifying `info.json`

This JSON file defines the metadata of your question. Make sure to use our custom docker image, and enable networking, within the `externalGradingOptions`, as follows:
```
{
    "uuid": "<AUTO-GENERATED>",
    "title": "<FIXME>",
    "topic": "<FIXME>",
    "tags": <FIXME>,
    "type": "v3",
    "singleVariant": true,
    "gradingMethod": "External",
    "externalGradingOptions": {
        "enabled": true,
        "image": "rosensh/custom-grader-python:latest",
        "entrypoint": "/python_autograder/run.sh",
        "timeout": 60,
        "enableNetworking": true
    }
}
```
You should run `docker pull rosensh/custom-grader-python:latest` in order to use the custom grader image.

## Modifying `test.py`

`Test.py` is where the magic happens. A few things of note:

-   We've concocted a GPT-3.5 prompt (leaning heavily on existing literature) that's proven magical in alpha tests. Stick to the script for best results.
-   Insert your own API key to unlock the sorcery.
-   Feel free to tinker with the scoring logic — our style below is all-or-nothing, but awarding partial credit might call for a dash of nuance.

Please consult the reference file for more details.

## Deleting `server.py`

Please remove this file — we’re using `test.py` for external grading.

## Starting up Docker

Please run the following command. Replace directory names / use the full path if you’re on Mac.
```
docker run -it --privileged --rm -p 3000:3000 -v $PWD:/course -v /Users/USERNAME/ag-temp-pl:/jobs -e HOST_JOBS_DIR=/Users/USERNAME/ag-temp-pl -v /var/run/docker.sock:/var/run/docker.sock --platform linux/amd64 prairielearn/prairielearn
```
